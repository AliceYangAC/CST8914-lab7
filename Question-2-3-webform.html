<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Form Validation</title>
    <meta charset="utf-8" />
    <style>
      .control,
      fieldset {
        margin: 6px 0;
      }

      label {
        display: inline-block;
        width: 120px;
        vertical-align: top;
      }

      input + label {
        width: auto;
      }

      .error,
      .required {
        color: red;
      }

      fieldset ul {
        margin: 0;
      }
    </style>
  </head>
  <body>
    <!-- 
      Explanation: Feedback Form
      - Sorted the 'User Information' inputs and 'Gender' radio 
      inputs into separate form groupings via fieldset for clarity; 
      one is for text fields, one is selecting between radio options 
      for one input.
      - Added legends to distinguish each grouping.
      - Ensured that every input is required when validating based on
      the intent of the form. Name and gender is required for 
      identification usually, and T&C is always required due to legal
      reasons. Without the Biography field, the form lacks a main 
      purpose.
     -->
    <form>
      <h1>Feedback Form</h1>
      <fieldset>
        <legend>User Information</legend>
        <div class="control">
          <label for="name">Full name <span class="required">*</span></label>
          <input
            id="name"
            name="name"
            type="text"
            required
            aria-required="true"
          />
          <!-- 
            Explanation: Name
            - Added for="name" attribute to tie the name label to 
            the input so screen readers read the label on input hover.
            - Added required and aria-required element for form
              validation & accessibility for screen readers.
          -->
        </div>
        <div class="control">
          <label id="bioLabel" for="biography"
            >Biography <span class="required">*</span>
          </label>
          <textarea
            id="biography"
            name="biography"
            aria-labelledby="bioLabel"
            type="text"
            aria-describedby="bioDesc"
            required
            aria-required="true"
          ></textarea>
          <p id="bioDesc">Include examples on your skills in JavaScript.</p>
          <!-- 
            Explanation: Biography
            - Added for="biography" attribute to tie the biography's label to 
            the input so screen readers read the label on input hover.
            - Added required and aria-required element for form 
            validation & accessibility for screen readers.
            - Added form instruction paragraph element that the 
            input reads on focus through the aria-describedby attribute.
            - Added asterisk for visual understanding that an 
            input choice is required.
          -->
        </div>
      </fieldset>
      <fieldset>
        <legend>Gender <span class="required">*</span></legend>
        <div class="control">
          <input
            id="gender_male"
            name="gender"
            type="radio"
            value="male"
            required
            aria-required="true"
          />
          <label for="gender_male">Male</label>
        </div>
        <div class="control">
          <input
            id="gender_female"
            name="gender"
            type="radio"
            value="female"
            required
            aria-required="true"
          /><label for="gender_female">Female</label>
        </div>
      </fieldset>
      <!-- 
        - Added for="gender_female" & for="gender_male" attribute to 
        tie each of the gender radio labels to their respective inputs
        so screen readers read the label on input hover.
        - Added required and aria-required element to one radio input 
        (which will apply to all associated radio buttons) for form 
        validation & accessibility for screen readers.
        - Added asterisk for visual understanding that an input choice 
        is required. 
      -->
      <div class="control">
        <input
          id="accept_agbs"
          name="accept_agbs"
          type="checkbox"
          value="1"
          required
          aria-required="true"
        /><label for="accept_agbs"
          >I accept the terms and conditions
          <span class="required">*</span></label
        >
        <!-- 
          Explanation: T&C
          - Added for="accept_agbs" attribute to tie the T&C label 
          to the checkbox input so screen readers read the label on 
          input hover.
          - Added required and aria-required element to the checkbox 
          input for form validation & accessibility for screen readers
          - Added asterisk for visual understanding that the input is 
          required.
        -->
      </div>
      <div class="control">
        <input name="validate" type="hidden" value="1" /><input
          type="submit"
          value="Register"
        />
      </div>
    </form>

    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"
      integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
      crossorigin="anonymous"
    ></script>
    <script>
      "use strict";

      (function () {
        var validateInput;

        $.urlParam = function (name) {
          var results;
          results = new RegExp("[?&]" + name + "=([^&#]*)").exec(
            window.location.href
          );

          if (results === null) {
            return null;
          } else {
            return decodeURI(results[1]) || null;
          }
        };

        validateInput = function validateInput(input, message) {
          var $elementToDescribe,
            $error,
            $errorContainer,
            $fieldset,
            $input,
            $referencedElement,
            value;
          $input = $('[name="' + input + '"]');

          if ((value = $.urlParam(input)) === null) {
            if ($("fieldset.errors").length === 0) {
              $("form").prepend(
                '<fieldset class="errors"><legend>Errors</legend><ul></ul></fieldset>'
              );
            }

            $referencedElement = null;
            $elementToDescribe = null;
            $errorContainer = $("fieldset.errors ul");

            if ($input.is(":radio")) {
              $fieldset = $input.closest("fieldset");
              $elementToDescribe = $fieldset;
              $referencedElement = $input.filter(":first");
            } else {
              $elementToDescribe = $input;
              $referencedElement = $input;
            }
            // R.G. hint: fix next line ;)
            $error = $("<a>" + message + "</a>");
            $error.click(function (e) {
              // If we rely on the link's href pointing to the input's ID, it doesn't trigger forms mode in screen readers
              $referencedElement.focus();
              return e.preventDefault();
            });
            $elementToDescribe.attr("aria-describedby", input + "_description");
            $errorContainer.append("<li>").find("li:last").append($error);

            if ($(":not(form):focus").length === 0) {
              // See https://stackoverflow.com/questions/46134247/jquery-setting-focus-doesnt-work-in-ie11/
            }
          } else {
            if ($input.is(":checkbox")) {
              $input.attr("checked", true);
            }

            if ($input.is(":radio")) {
              return $input
                .filter('[value="' + value + '"]')
                .attr("checked", true);
            } else {
              return $input.val(value);
            }
          }
        };

        $(document).ready(function () {
          if ($.urlParam("validate")) {
            validateInput("name", "Please enter your name!");
            validateInput(
              "biography",
              "Please tell us something about your history!"
            );
            validateInput("gender", "Please tell us your gender!");
            validateInput(
              "accept_agbs",
              "You must accept our terms and conditions!"
            );

            if ($(".error").length === 0) {
              return alert("All inputs are valid.");
            }
          }
        });
      }).call(void 0);
    </script>
  </body>
</html>
